(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const s of t.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function a(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(o){if(o.ep)return;o.ep=!0;const t=a(o);fetch(o.href,t)}})();function j(e){const n=document.querySelector(".filter__tag");if(!n)return;n.querySelectorAll("button").forEach(l=>{l.addEventListener("click",o=>{o.preventDefault(),l.classList.toggle("active");const t=l.innerText.toLowerCase();if(e.labels.includes(t)){const s=e.labels.indexOf(t);s>-1&&e.labels.splice(s,1)}else e.labels.push(t);S(e)})})}async function W(e){if(document.querySelector("#challenges__container")){const l=document.querySelector(".filter__first-rate"),o=document.querySelector(".filter__second-rate"),t=l.querySelectorAll("i"),s=o.querySelectorAll("i"),u=l.querySelectorAll(".star-button"),p=o.querySelectorAll(".star-button");let i=-1,m=-1;if(t&&s){let d=function(r){i===r?(t.forEach(c=>{c.classList.remove("fa-solid"),c.classList.add("fa-regular")}),i=-1):(t.forEach((c,f)=>{r>=f?(c.classList.remove("fa-regular"),c.classList.add("fa-solid")):(c.classList.remove("fa-solid"),c.classList.add("fa-regular"))}),i=r)},h=function(r){m===r?(s.forEach(c=>{c.classList.remove("fa-solid"),c.classList.add("fa-regular")}),m=-1):(s.forEach((c,f)=>{r>=f?(c.classList.remove("fa-regular"),c.classList.add("fa-solid")):(c.classList.remove("fa-solid"),c.classList.add("fa-regular"))}),m=r)};var n=d,a=h;u.forEach((r,c)=>{r.addEventListener("click",f=>{f.preventDefault(),d(c),u.forEach((g,y)=>{g.setAttribute("aria-pressed",c===y&&c===i)}),e.minRating=r.getAttribute("aria-pressed")==="true"?c+1:0,S(e)})}),p.forEach((r,c)=>{r.addEventListener("click",f=>{f.preventDefault(),h(c),p.forEach((g,y)=>{g.setAttribute("aria-pressed",c===y&&c===m)}),e.maxRating=r.getAttribute("aria-pressed")==="true"?c+1:5,S(e)})})}}}function H(){document.querySelector(".filter__form").reset()}function Y(e){const n=document.querySelector("#filter__text");n&&n.addEventListener("input",()=>{const a=n.value.toLowerCase();e.text=a,(a.length===0||a.length>=3)&&S(e)})}function J(e){const n=document.querySelector("#online-challenges"),a=document.querySelector("#on-site-challenges");n&&n.addEventListener("change",()=>{if(n.checked)e.types.includes("online")||e.types.push("online");else{const l=e.types.indexOf("online");l>-1&&e.types.splice(l,1)}S(e)}),a&&a.addEventListener("change",()=>{if(a.checked)e.types.includes("onsite")||e.types.push("onsite");else{const l=e.types.indexOf("onsite");l>-1&&e.types.splice(l,1)}S(e)})}function K(){const e={types:[],labels:[],minRating:0,maxRating:5,text:""};J(e),j(e),W(e),Y(e),H()}function S(e){const n=document.querySelectorAll(".challenges__room"),a=document.querySelector("#challenges__container");let l=a.querySelector(".filter__message");if(l||(l=document.createElement("p"),l.textContent="No matching challenges",l.classList.add("filter__message")),n.forEach(t=>{t.style.display="none"}),e.types.length===0&&e.labels.length===0&&!e.text&&e.minRating===0&&e.maxRating===5){n.forEach(t=>{t.style.display=""}),l.remove();return}const o=Array.from(n).filter(t=>{const s=t.getAttribute("id"),u=t.dataset.labels.split(","),p=t.querySelector(".room__heading").textContent.toLowerCase(),i=t.querySelector(".room__info").textContent.toLowerCase(),m=t.rating,d=e.types.length===0||e.types.includes(s),h=e.labels.length===0||e.labels.every(f=>u.includes(f)),r=!e.text||p.includes(e.text)||i.includes(e.text),c=m>=e.minRating&&m<=e.maxRating;return d&&h&&r&&c});o.length===0?a.appendChild(l):(l.remove(),o.forEach(t=>{t.style.display=""}))}const T=document.createElement("div"),k=document.createElement("div"),M=document.createElement("p"),R=document.createElement("p"),O=document.createElement("section"),q=document.createElement("h3"),L=document.createElement("input"),b=document.createElement("span"),A=document.createElement("button"),D=document.createElement("button");let _=document.createElement("p"),I=null;k.className="modal";T.className="modal__content";q.className="modal__title";M.className="modal__p-text";R.className="modal__p-date";L.className="modal__input";A.className="modal__button";D.className="modal__button_close";_.className="modal__date_error_text";q.textContent="Book room";M.textContent="What date would you like to come?";R.textContent="Date";A.textContent="Search available times";_.textContent="";L.type="date";L.setAttribute("data-date-format","YYYY MM DD");k.setAttribute("id","hidden");_.setAttribute("id","hidden");document.body.appendChild(O);O.appendChild(k);k.appendChild(T);T.appendChild(b);b.appendChild(q);b.appendChild(M);b.appendChild(R);b.appendChild(L);b.appendChild(A);b.appendChild(D);const F=document.querySelector(".modal__title"),B=document.querySelector(".modal__title2");let w=null;function z(){return document.querySelectorAll(".room__button--onsite").forEach(n=>{n.addEventListener("click",()=>{const a=n.closest(".challenges__room")||n.closest(".content__room");w=a.getAttribute("data-id");const o=a.querySelector(".room__heading").textContent,t=a.querySelector(".room__participants").textContent,s=document.querySelector("#participants_number"),u=parseInt(t),p=parseInt(t.split("-")[1]);k.removeAttribute("id"),q.textContent=`Book room "${o}" (step 1)`,I=o,B&&(B.className=F.className,B.textContent=F.textContent),s.innerHTML="";for(let i=u;i<=p;i++){const m=document.createElement("option");m.value=i,m.textContent=`${i} participants`,s.appendChild(m)}})}),I}function P(e){return _.textContent=e,_.style.animation="none",_.offsetWidth,_.style.animation="",_}function G(){if(!L.value){b.appendChild(_),P("No date selected"),_.removeAttribute("id");return}const e=`https://lernia-sjj-assignments.vercel.app/api/booking/available-times?date=${L.value}&challenge=${w}`;fetch(e).then(n=>{if(!n.ok)throw b.appendChild(_),P("Invalid date selected"),_.removeAttribute("id"),new Error("Network response was not ok");return n.json()}).then(n=>{const a=new CustomEvent("arrayEvent",{detail:{message:"Button clicked, sending array!",data:n.slots,id:w,title:I}});_.remove(),k.setAttribute("id","hidden"),document.dispatchEvent(a),document.querySelector(".overlay").style.display="initial",document.querySelector(".Bookroom_modal").style.display="flex"}).catch(n=>{console.error("Fetch error:",n)})}A.addEventListener("click",()=>{G()});function Q(){const e=document.querySelector(".header__menu-button"),n=document.querySelector(".header__navigation-close"),a=document.querySelector(".header__navigation"),l=document.querySelector(".overlay__blur"),o=document.querySelector(".modal__button_close"),t=document.querySelector(".modal");e.addEventListener("click",s),n.addEventListener("click",u),l.addEventListener("click",u);function s(){a.classList.add("overlay"),l.classList.add("active"),document.body.style.overflow="hidden"}function u(){a.classList.remove("overlay"),l.classList.remove("active"),document.body.style.overflow=""}o.addEventListener("click",()=>{t.setAttribute("id","hidden")});function p(){const d=document.querySelector(".filter__button"),h=document.querySelector(".filter__form"),r=document.querySelector(".filter__form__close-button");d&&h&&r&&(d.addEventListener("click",c),r.addEventListener("click",f));function c(){h.style.display="block",d.style.display="none"}function f(){h.style.display="none",d.style.display=""}}p(),document.addEventListener("DOMContentLoaded",()=>{const d=document.querySelector(".overlay");d&&d.addEventListener("click",h);function h(){const r=document.querySelector(".Bookroom_modal");r&&(r.style.display="none"),d.style.display="none"}});const i=document.querySelectorAll(".introduction__button--online, .content__navigation-link, .introduction__button--onsite, .content__navigation-button, .play__button--book, .play__button--challenges"),m=document.querySelectorAll(".header__logo, .header__title");i.forEach(d=>{d&&d.addEventListener("click",()=>{window.location.href="./challenges.html"})}),m.forEach(d=>{d&&d.addEventListener("click",()=>{window.location.href="./index.html"})})}async function U(){return await(await fetch("https://lernia-sjj-assignments.vercel.app/api/challenges")).json()}function V(){const e=document.querySelector("body"),n=document.createElement("div"),a=document.createElement("section"),l=document.createElement("div"),o=document.createElement("form"),t=document.createElement("h2"),s=document.createElement("label"),u=document.createElement("input"),p=document.createElement("label"),i=document.createElement("input"),m=document.createElement("label"),d=document.createElement("select"),h=document.createElement("option"),r=document.createElement("label"),c=document.createElement("select"),f=document.createElement("option"),g=document.createElement("button"),y=document.createElement("label"),v=document.createElement("input");n.className="overlay",n.setAttribute("id","hidden"),a.className="Bookroom_modal",a.setAttribute("id","hidden"),l.className="book_modal",o.className="book_form",t.className="modal__title2",s.className="book_name",s.setAttribute("for","name-text"),u.type="text",u.id="name-text",p.className="book_email",p.setAttribute("for","email-text"),i.type="email",i.id="email-text",m.className="book_time",m.setAttribute("for","time_options"),d.id="time_options",r.className="book_participants",r.setAttribute("for","participants_number"),c.id="participants_number",g.className="booking_button",y.className="phone_number",y.setAttribute("for","phone-number"),v.type="tel",v.id="phone-number",v.value="(+46)",t.textContent="",s.textContent="Name",y.textContent="Phone number(optional)",p.textContent="Email",m.textContent="What time?",r.textContent="How many participants?",g.textContent="Submit booking",e.appendChild(n),e.appendChild(a),a.appendChild(l),l.appendChild(o),o.appendChild(t),o.appendChild(s),o.appendChild(u),o.appendChild(y),o.appendChild(v),o.appendChild(p),o.appendChild(i),o.appendChild(m),o.appendChild(d),d.appendChild(h),o.appendChild(r),o.appendChild(c),c.appendChild(f),o.appendChild(g)}V();const X=document.querySelector(".book_form"),Z=document.querySelector(".modal__title2");let $;function ee(e){return $=e,e}function te(e){return Z.textContent=`Book room "${e}" (step 2)`,e}document.addEventListener("arrayEvent",e=>{const{data:n,id:a,title:l}=e.detail;let o=n;ee(a),te(l),ne(o)});X.addEventListener("submit",e=>{e.preventDefault();const n=parseInt($,10),a=document.getElementById("name-text").value,l=document.getElementById("phone-number").value,o=document.getElementById("email-text").value,t=new Date().toISOString(),s=document.getElementById("time_options").value,u=document.getElementById("participants_number").value,p={challenge:n,name:a,phone:l,email:o,date:t,time:s,participants:parseInt(u,10)};fetch("https://lernia-sjj-assignments.vercel.app/api/booking/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)}).then(i=>{if(!i.ok)throw alert("All fields must be filled!"),new Error("Network response was not ok");return i.json()}).then(()=>{var d;document.querySelector(".modal3").removeAttribute("id");let i=(d=document.querySelector("#phone-number"))==null?void 0:d.value,m=document.querySelector("#phone-number");m.addEventListener("focus",()=>{m.value.startsWith("(+46)")||(m.value="(+46)")}),i&&i.length===10&&!isNaN(i)?(console.log(`Phone number provided: ${i}`),document.querySelector(".modal3").removeAttribute("id")):isNaN(i)&&i.length===15?(m=i.substring(5,15),console.log(`Phone number provided: ${m}`),document.querySelector(".modal3").removeAttribute("id")):i.length!==0&&i.length!==15&&i.length!==10?(console.log("Wrong phone format, try again"),document.querySelector(".modal3")&&document.querySelector(".modal3").setAttribute("id","hidden")):(document.querySelector("#phone-number").value="",console.log("Phone number not provided, not an requirement"),document.querySelector(".modal3").removeAttribute("id"))})});function ne(e){const n=document.querySelector("#time_options");n.innerHTML="",e.forEach(a=>{const l=document.createElement("option");l.value=a,l.textContent=a,n.appendChild(l)})}function oe(){const e=document.createElement("section"),n=document.createElement("div"),a=document.createElement("h2"),l=document.createElement("a");n.id="modal3",n.className="modal3",a.className="modalTitle",l.className="challengesLink",n.setAttribute("id","hidden"),a.textContent="Thank you!",l.textContent="Back to challenges",l.href="./challenges.html",document.body.appendChild(e),e.appendChild(n),n.appendChild(a),n.appendChild(l)}oe();async function le(){const n=(await U()).challenges,a=document.querySelector("#challenges__container"),l=document.querySelector(".content__rooms");let o;a?o=a:l&&(o=l,n.sort((t,s)=>s.rating-t.rating),n.length=3),o.innerHTML="",n.forEach(t=>{const s=document.createElement("div");s.classList.add(l?"content__room":"challenges__room"),s.setAttribute("data-labels",t.labels.join(",")),s.setAttribute("data-id",t.id),s.rating=t.rating,t.type==="online"?s.setAttribute("id","online"):s.setAttribute("id","onsite"),o.appendChild(s);const u=document.createElement("div");u.classList.add("room"),s.appendChild(u);const p=document.createElement("div");p.classList.add("room__image-container"),u.appendChild(p);const i=document.createElement("img");i.classList.add("room__img"),i.src=t.image,i.alt=`Picture of the room ${t.title}`,p.appendChild(i);const m=document.createElement("div");m.classList.add("room__type-icon");const d=document.createElement("i");t.type==="online"?d.classList.add("fa-solid","fa-laptop"):d.classList.add("fa-solid","fa-house"),m.appendChild(d),p.appendChild(m);const h=document.createElement("h3");h.classList.add("room__heading"),h.textContent=`${t.title} (${t.type})`,u.appendChild(h);const r=document.createElement("div");r.classList.add("room__stars"),p.appendChild(r);const c=Math.floor(t.rating),f=t.rating%1!==0,g=5-Math.ceil(t.rating);for(let C=0;C<c;C++){const x=document.createElement("i");x.classList.add("fa-solid","fa-star"),r.appendChild(x)}if(f){const C=document.createElement("i");C.classList.add("fa-solid","fa-star-half-stroke"),r.appendChild(C)}for(let C=0;C<g;C++){const x=document.createElement("i");x.classList.add("fa-regular","fa-star"),r.appendChild(x)}const y=document.createElement("p");y.classList.add("room__participants"),y.textContent=`${t.minParticipants} - ${t.maxParticipants} participants`,u.appendChild(y);const v=document.createElement("p");v.classList.add("room__info"),v.textContent=t.description,u.appendChild(v);const N=document.createElement("div");N.classList.add("challenges__actions"),u.appendChild(N);const E=document.createElement("button");E.type="button",t.type==="onsite"?(E.textContent="Book this room",E.classList.add("room__button--onsite")):t.type==="online"&&(E.textContent="Take challenge online",E.classList.add("room__button--online")),N.appendChild(E)}),z()}Q();(document.querySelector("#challenges__container")||document.querySelector(".content__rooms"))&&le();document.querySelector("#challenges__container")&&K();
